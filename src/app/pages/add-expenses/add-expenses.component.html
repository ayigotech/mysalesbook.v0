<!-- add-expenses.component.html -->
<ion-content class="add-expenses-content" fullscreen>
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <button class="back-btn" (click)="goBack()">
        <ion-icon name="arrow-back"></ion-icon>
      </button>
            <h1 class="page-title">Add Expense</h1>
            <div class="header-actions">
                <button class="save-btn" (click)="saveExpense()" [disabled]="!canSave()">
          Save
        </button>
            </div>
        </div>
    </div>

    <!-- Info Banner -->
    <div class="info-banner">
        <div class="info-icon">
            <ion-icon name="information-circle"></ion-icon>
        </div>
        <div class="info-content">
            <p class="info-title">Track Your Expenses</p>
            <p class="info-text">
                Record all business expenses to accurately calculate your net profit. Include even small daily expenses for better financial tracking.
            </p>
        </div>
    </div>

    <!-- Main Form -->
    <div class="form-container">
        <!-- Amount Input -->
        <div class="input-group">
            <label class="input-label">Amount (GHS) *</label>
            <div class="amount-input-container">
                <span class="currency-symbol">GHS</span>
                <input type="number" class="amount-input" placeholder="0.00" [(ngModel)]="expenseData.amount" (input)="validateAmount()" autofocus>
            </div>
            <div class="input-error" *ngIf="showAmountError">
                Please enter a valid amount
            </div>
        </div>

        <!-- Quick Amount Buttons -->
        <div class="quick-amounts">
            <button *ngFor="let amount of quickAmounts" class="quick-amount-btn" (click)="setQuickAmount(amount)" [class.active]="expenseData.amount === amount">
        GHS {{amount}}
      </button>
        </div>

        <!-- DateTime -->
        <div class="input-group">
            <label class="input-label">Date & Time</label>
            <div class="datetime-display" (click)="showDateTimePicker()">
                <ion-icon name="calendar"></ion-icon>
                <span class="datetime-text">{{expenseData.datetime | date:'MMM d, y - h:mm a'}}</span>
                <ion-icon name="chevron-down" class="chevron"></ion-icon>
            </div>
        </div>

        <!-- Category -->
        <div class="input-group">
            <label class="input-label">Category *</label>
            <div class="category-select" (click)="showCategoryPicker()">
                <span class="category-text">
          {{expenseData.category || 'Select category'}}
        </span>
                <ion-icon name="chevron-down" class="chevron"></ion-icon>
            </div>
        </div>

        <!-- Vendor -->
        <div class="input-group">
            <label class="input-label">Vendor/Payee (Optional)</label>
            <input type="text" class="text-input" placeholder="Who did you pay?" [(ngModel)]="expenseData.vendor">
        </div>

        <!-- Payment Method -->
        <div class="input-group">
            <label class="input-label">Payment Method</label>
            <div class="payment-methods">
                <button *ngFor="let method of paymentMethods" class="payment-method-btn" (click)="expenseData.paymentMethod = method" [class.active]="expenseData.paymentMethod === method">
          <ion-icon [name]="getPaymentMethodIcon(method)"></ion-icon>
          {{method | titlecase}}
        </button>
            </div>
        </div>

        <!-- Description -->
        <div class="input-group">
            <label class="input-label">Description (Optional)</label>
            <textarea class="notes-input" placeholder="What was this expense for?" [(ngModel)]="expenseData.description" rows="3"></textarea>
        </div>

        <!-- Recent Expenses Quick Add -->
        <!-- <div class="recent-expenses" *ngIf="recentExpenses.length > 0">
            <h3 class="section-title">Quick Add from Recent</h3>
            <div class="recent-expenses-list">
                <div *ngFor="let recent of recentExpenses" class="recent-expense-item" (click)="fillFromRecent(recent)" (swipe)="onSwipeRecent($event, recent)">
                    <div class="recent-amount">GHS {{recent.amount}}</div>
                    <div class="recent-details">
                        <span class="recent-vendor">{{recent.vendor}}</span>
                        <span class="recent-category">{{recent.category}}</span>
                        <span class="recent-time">{{getTimeAgo(recent.datetime)}}</span>
                    </div>
                    <div class="swipe-action">Fill</div>
                </div>
            </div>
        </div> -->
    </div>

    <!-- Floating Action for Quick Save -->
    <button class="fab-save" (click)="quickSave()" [class.active]="canSave()">
    <ion-icon name="checkmark"></ion-icon>
  </button>
</ion-content>

<!-- Category Picker Modal -->
<ion-modal [isOpen]="showCategoryModal" (didDismiss)="showCategoryModal = false">
    <ng-template>
        <ion-header>
            <ion-toolbar class="select-category">
                <ion-title>Select Category</ion-title>
                <ion-buttons slot="end">
                    <ion-button (click)="showCategoryModal = false">Close</ion-button>
                </ion-buttons>
            </ion-toolbar>
        </ion-header>
        <ion-content class="select-category">
            <div class="category-options">
                <button *ngFor="let category of categories" class="category-option" (click)="selectCategory(category)" [class.selected]="expenseData.category === category">
          {{category}}
        </button>
            </div>
        </ion-content>
    </ng-template>
</ion-modal>
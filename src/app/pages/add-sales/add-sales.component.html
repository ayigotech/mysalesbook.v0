<ion-content class="add-sales-content" fullscreen>

    <!-- <ion-refresher slot="fixed" (ionRefresh)="refreshPage($event)">
        <ion-refresher-content></ion-refresher-content>
    </ion-refresher> -->

    <!-- HEADER -->
    <div class="header">
        <div class="header-content">
            <button class="back-btn" (click)="goBack()">
        <ion-icon name="arrow-back"></ion-icon>
      </button>
            <h1 class="page-title">Add Sales</h1>
            <div class="header-actions">
                <button class="save-btn" (click)="saveSale()" [disabled]="!canSave()">
          Save
        </button>
            </div>
        </div>
    </div>

    <!-- INFO BANNER -->
    <div class="info-banner">
        <div class="info-icon">
            <ion-icon name="information-circle"></ion-icon>
        </div>
        <div class="info-content">
            <p class="info-title">Recording Tips</p>
            <p class="info-text">
                <strong>Recommended:</strong> Record sales as they happen for accurate tracking.
            </p>
        </div>
    </div>

    <!-- FORM -->
    <div class="form-container">

        <!-- AMOUNT -->
        <div class="input-group">
            <label class="input-label">Amount (GHS) *</label>
            <div class="amount-input-container">
                <span class="currency-symbol">GHS</span>
                <input type="number" class="amount-input" placeholder="0.00" [(ngModel)]="saleData.amount">
            </div>
        </div>

        <!-- QUICK AMOUNT BUTTONS -->
        <div class="quick-amounts">
            <button *ngFor="let amount of quickAmounts" class="quick-amount-btn" (click)="setQuickAmount(amount)">
        GHS {{ amount }}
      </button>
        </div>

        <!-- DATE & TIME -->
        <!-- <div class="input-group">
            <label class="input-label">Date & Time</label>

            <div class="datetime-display" (click)="openDateModal()">
                <ion-icon name="calendar"></ion-icon>
                <span class="datetime-text">
          {{ saleData.datetime | date:'MMM d, y - h:mm a' }}
        </span>
                <ion-icon name="chevron-down" class="chevron"></ion-icon>
            </div>
        </div> -->


        <div class="input-group">
            <label class="input-label">Date</label>
            <input matInput [matDatepicker]="picker" [(ngModel)]="saleData.datetime" (dateChange)="onDateChange($event)" placeholder="Choose date">
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
        </div>


        <!-- CUSTOMER -->
        <div class="input-group">
            <label class="input-label">Customer (Optional)</label>
            <input class="text-input" type="text" [(ngModel)]="saleData.customer" placeholder="Customer name">
        </div>

        <!-- CATEGORY -->
        <div class="input-group">
            <label class="input-label">Category (Optional)</label>

            <div class="category-select" (click)="openCategoryModal()">
                <span class="category-text">
          {{ saleData.category || 'Select category' }}
        </span>
                <ion-icon name="chevron-down"></ion-icon>
            </div>
        </div>

    </div>

    <!-- FLOAT SAVE -->
    <button class="fab-save" (click)="quickSave()" [class.active]="canSave()">
    <ion-icon name="checkmark"></ion-icon>
  </button>

</ion-content>

<!-- CATEGORY PICKER MODAL -->
<ion-modal [isOpen]="showCategoryModal" (didDismiss)="showCategoryModal = false">

    <ng-template>
        <ion-header>
            <ion-toolbar>
                <ion-title>Select Category</ion-title>
                <ion-buttons slot="end">
                    <ion-button (click)="showCategoryModal = false">Close</ion-button>
                </ion-buttons>
            </ion-toolbar>
        </ion-header>

        <ion-content>
            <div class="category-options">
                <button *ngFor="let category of categories" class="category-option" [class.selected]="saleData.category === category" (click)="selectCategory(category)">
          {{ category }}
        </button>
            </div>
        </ion-content>
    </ng-template>

</ion-modal>